<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Me â€“ SPA BÃ¡sica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css" />

    <!-- âœ¨ Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="" />
</head>
<body>

<h1>Find Me</h1>

<!-- NavegaciÃ³n -->
<nav class="nav">
    <button class="nav__button" id="btnNavAvistador">Registrarme</button>
    <button class="nav__button" id="btnNavForm">Registrar desaparecido</button>
    <button class="nav__button" id="btnNavList">Ver lista</button>
    <button class="nav__button" id="btnNavMapa">ğŸ—ºï¸ Mapa</button>
    <span style="flex:1"></span>
    <button class="nav__button" id="btnLogin">Iniciar sesiÃ³n</button>
    <button class="nav__button u-hidden" id="btnLogout">Cerrar sesiÃ³n</button>
</nav>

<div class="session-status" id="sessionStatus"></div>

<!-- ============================================ -->
<!-- SECCIÃ“N: LOGIN -->
<!-- ============================================ -->
<section class="section" id="loginSection">
    <h2>Iniciar SesiÃ³n</h2>
    <div class="u-text-muted u-mb-2" id="loginMessage"></div>

    <form id="formLogin" novalidate>
        <input
                class="form__input"
                type="text"
                id="login_dni"
                placeholder="DNI (7 a 10 dÃ­gitos)"
                pattern="[0-9]{7,10}"
                inputmode="numeric"
                maxlength="10"
                required
        />
        <input
                class="form__input"
                type="email"
                id="login_email"
                placeholder="Email registrado"
                required
        />
        <button class="button button--primary" type="submit" id="btnLoginSubmit">
            Iniciar SesiÃ³n
        </button>
    </form>

    <div class="form__message" id="loginResult"></div>

    <div class="divider">â€” o â€”</div>

    <button type="button" class="button button--secondary" id="btnGoRegister">
        No tengo cuenta, quiero registrarme
    </button>
</section>

<!-- ============================================ -->
<!-- SECCIÃ“N: REGISTRAR AVISTADOR -->
<!-- ============================================ -->
<section class="section" id="avistadorSection">
    <h2>Crear mi cuenta (Avistador)</h2>
    <form id="formAvistador" novalidate>
        <div class="form__row">
            <input class="form__input" type="text" id="a_nombre" placeholder="Nombre" required />
            <input class="form__input" type="text" id="a_apellido" placeholder="Apellido" required />
        </div>
        <div class="form__row">
            <input class="form__input" type="text" id="a_dni" placeholder="DNI (7 a 10 dÃ­gitos)" pattern="[0-9]{7,10}" inputmode="numeric" maxlength="10" required />
            <input class="form__input" type="number" id="a_edad" placeholder="Edad" min="0" required />
        </div>
        <input class="form__input" type="text" id="a_direccion" placeholder="DirecciÃ³n" required />
        <div class="form__row">
            <input class="form__input" type="email" id="a_email" placeholder="Email (importante para login)" required />
            <input class="form__input" type="tel" id="a_telefono" placeholder="TelÃ©fono (opcional)" />
        </div>
        <button class="button button--primary" type="submit" id="btnAvistador">
            Registrarme
        </button>
    </form>
    <div class="form__message" id="outAvistador"></div>
</section>

<!-- ============================================ -->
<!-- SECCIÃ“N: REGISTRAR DESAPARECIDO -->
<!-- ============================================ -->
<section class="section section--active" id="formSection">
    <h2>Registrar Persona Desaparecida</h2>
    <form id="formDesaparecido" novalidate>
        <div class="form__row">
            <input class="form__input" type="text" id="nombre" placeholder="Nombre" required />
            <input class="form__input" type="text" id="apellido" placeholder="Apellido" required />
        </div>
        <div class="form__row">
            <input class="form__input" type="number" id="edad" placeholder="Edad" min="0" required />
            <input class="form__input" type="text" id="dni" placeholder="DNI (7 a 10 dÃ­gitos)" pattern="[0-9]{7,10}" inputmode="numeric" maxlength="10" required/>
        </div>
        <textarea class="form__textarea" id="descripcion" placeholder="DescripciÃ³n" required></textarea>
        <input class="form__input" type="url" id="fotoUrl" placeholder="URL de la Foto (opcional)" />
        <button class="button button--primary" type="submit" id="btnSubmit">
            Enviar
        </button>
    </form>
    <div class="form__message" id="resultado"></div>
</section>

<!-- ============================================ -->
<!-- SECCIÃ“N: LISTA DE DESAPARECIDOS -->
<!-- ============================================ -->
<section class="section" id="listSection">
    <h2>Lista de Desaparecidos</h2>
    <button class="button button--secondary u-mb-2" id="btnReload">
        â†» Recargar lista
    </button>
    <div class="u-text-muted" id="listaEstado"></div>
    <table class="table">
        <thead>
        <tr>
            <th class="table__header table__cell">Nombre</th>
            <th class="table__header table__cell">Apellido</th>
            <th class="table__header table__cell">DNI</th>
            <th class="table__header table__cell">DescripciÃ³n</th>
            <th class="table__header table__cell">Foto</th>
            <th class="table__header table__cell">Fecha</th>
        </tr>
        </thead>
        <tbody id="tablaDesaparecidosBody"></tbody>
    </table>
</section>

<!-- ============================================ -->
<!-- SECCIÃ“N: MAPA DE AVISTAMIENTOS -->
<!-- ============================================ -->
<section class="section" id="mapaSection">
    <h2>Mapa de Avistamientos</h2>

    <div class="map__controls">
        <button class="button button--secondary" id="btnReloadMapa">
            ğŸ”„ Actualizar Mapa
        </button>
        <button class="button button--primary" id="btnToggleReportar">
            ğŸ“ Activar Modo Reportar
        </button>
    </div>

    <div class="map__status" id="mapaEstado"></div>

    <!-- Contenedor del mapa -->
    <div class="map" id="map"></div>
</section>

<!-- ============================================ -->
<!-- MODAL: REPORTAR AVISTAMIENTO -->
<!-- ============================================ -->
<div class="modal u-hidden" id="modalAvistamiento">
    <div class="modal__content">
        <div class="modal__header">
            <h3 class="modal__title">ğŸ“ Reportar Avistamiento</h3>
            <button class="modal__close" id="btnCloseModal">&times;</button>
        </div>

        <div class="modal__body">
            <div class="modal__coords" id="modalCoords">
                ğŸ“ UbicaciÃ³n: <span id="modalLatLng"></span>
            </div>

            <form id="formAvistamiento" novalidate>
                <label class="form__label">
                    <span class="form__label-text">Persona desaparecida *</span>
                    <select class="form__input" id="av_desaparecido" required>
                        <option value="">-- Seleccionar --</option>
                    </select>
                </label>

                <label class="form__label">
                    <span class="form__label-text">DescripciÃ³n del avistamiento *</span>
                    <textarea
                            class="form__textarea"
                            id="av_descripcion"
                            placeholder="Ej: Vi a esta persona cerca del parque..."
                            minlength="20"
                            required
                    ></textarea>
                    <small class="form__hint">MÃ­nimo 20 caracteres</small>
                </label>

                <label class="form__label">
                    <span class="form__label-text">Foto (URL, opcional)</span>
                    <input class="form__input" type="url" id="av_foto" placeholder="https://..." />
                </label>

                <label class="form__label form__label--checkbox">
                    <input type="checkbox" id="av_publico" checked />
                    <span>Hacer pÃºblico este avistamiento</span>
                </label>

                <button class="button button--primary" type="submit" id="btnSubmitAvistamiento">
                    Enviar Avistamiento
                </button>
            </form>

            <div class="form__message" id="avistamientoResult"></div>
        </div>
    </div>
</div>

<!-- âœ¨ Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

<!-- Tu script -->
<script type="module" src="js/app-auth.js"></script>

</body>
</html>